<!DOCTYPE html>
<html>
  <head>
    <title>Free Address Suggestion (jQuery + OSM)</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
      #suggestions {
        list-style: none;
        padding-left: 0;
        margin-top: 0;
        border: 1px solid #ccc;
        max-width: 300px;
        background: #fff;
        position: absolute;
        z-index: 1000;
      }
      #suggestions li {
        padding: 8px;
        cursor: pointer;
      }
      #suggestions li:hover {
        background-color: #f0f0f0;
      }
    </style>
  </head>
  <body>
    <label for="address-input">Enter address:</label><br>
    <input id="address-input" type="text" autocomplete="off" style="width: 300px; padding: 8px;" />
    <ul id="suggestions"></ul>

    <script>
      $(document).ready(function () {
        let typingTimer;
        const delay = 300; // milliseconds

        $("#address-input").on("input", function () {
          clearTimeout(typingTimer);
          const query = $(this).val();

          if (query.length > 2) {
            typingTimer = setTimeout(function () {
              $.get("https://photon.komoot.io/api/", { q: query, limit: 5 })
                .done(function (data) {
                  const suggestions = data.features.map(function (feature) {
                    const props = feature.properties;
                    return `${props.name || ""}, ${props.city || props.state || ""}, ${props.country || ""}`;
                  });

                  const $list = $("#suggestions").empty();
                  suggestions.forEach(function (s) {
                    $("<li>").text(s).appendTo($list).click(function () {
                      $("#address-input").val(s);
                      $list.empty();
                    });
                  });
                });
            }, delay);
          } else {
            $("#suggestions").empty();
          }
        });

        // Optional: Hide suggestions if clicked outside
        $(document).on("click", function (e) {
          if (!$(e.target).closest("#address-input, #suggestions").length) {
            $("#suggestions").empty();
          }
        });
      });
    </script>
  </body>
</html>